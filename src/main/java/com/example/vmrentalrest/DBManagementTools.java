package com.example.vmrentalrest;

import com.example.vmrentalrest.managers.RentManager;
import com.example.vmrentalrest.managers.UserManager;
import com.example.vmrentalrest.managers.VirtualDeviceManager;
import com.example.vmrentalrest.model.Rent;
import com.example.vmrentalrest.model.enums.*;
import com.example.vmrentalrest.model.users.Address;
import com.example.vmrentalrest.model.users.Administrator;
import com.example.vmrentalrest.model.users.Client;
import com.example.vmrentalrest.model.users.ResourceManager;
import com.example.vmrentalrest.model.virtualdevices.VirtualDatabaseServer;
import com.example.vmrentalrest.model.virtualdevices.VirtualMachine;
import com.example.vmrentalrest.model.virtualdevices.VirtualPhone;
import com.example.vmrentalrest.repositories.RentRepository;
import com.example.vmrentalrest.repositories.UserRepository;
import com.example.vmrentalrest.repositories.VirtualDeviceRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Component;

import java.time.LocalDateTime;

@Component
@RequiredArgsConstructor
public class DBManagementTools {
    private final UserRepository userRepository;
    private final RentRepository rentRepository;
    private final VirtualDeviceRepository virtualDeviceRepository;
    private final UserManager userManager;
    private final RentManager rentManager;
    private final VirtualDeviceManager virtualDeviceManager;
    public void clearRecords() {
        userRepository.deleteAll();
        rentRepository.deleteAll();
        virtualDeviceRepository.deleteAll();
    }
    public void createData() {
        Client client1 = new Client();
        Address address1 = new Address();
        address1.setCity("Lodz");
        address1.setStreet("Aleje Politechniki");
        address1.setHouseNumber("4/7");
        client1.setUsername("Pudzianator");
        client1.setFirstName("Mariusz");
        client1.setLastName("Pudzianowski");
        client1.setAddress(address1);
        client1.setClientType(ClientType.BRONZE);
        userManager.createUser(client1, UserType.CLIENT);
        Client client2 = new Client();
        Address address2 = new Address();
        address2.setCity("Warszawa");
        address2.setStreet("Nowy Swiat");
        address2.setHouseNumber("7");
        client2.setUsername("małyszo2");
        client2.setFirstName("Adam");
        client2.setLastName("Małysz");
        client2.setAddress(address2);
        client2.setClientType(ClientType.BRONZE);
        userManager.createUser(client2, UserType.CLIENT);
        Client client3 = new Client();
        Address address5 = new Address();
        address5.setCity("Pabianice");
        address5.setStreet("Jana Pawla 2");
        address5.setHouseNumber("21");
        client3.setUsername("kamil");
        client3.setFirstName("Kamil");
        client3.setLastName("Stoch");
        client3.setAddress(address5);
        client3.setClientType(ClientType.GOLD);
        userManager.createUser(client3, UserType.CLIENT);
        Administrator administrator = new Administrator();
        Address address3 = new Address();
        address3.setCity("Płock");
        address3.setStreet("Kościuszki");
        address3.setHouseNumber("1");
        administrator.setUsername("admin");
        administrator.setFirstName("Jan");
        administrator.setLastName("Kowalski");
        administrator.setAddress(address3);
        userManager.createUser(administrator, UserType.ADMINISTRATOR);
        ResourceManager resourceManager = new ResourceManager();
        Address address4 = new Address();
        address4.setCity("Gdynia");
        address4.setStreet("Mickiewicza");
        address4.setHouseNumber("2");
        resourceManager.setUsername("resmanager");
        resourceManager.setFirstName("Andrzej");
        resourceManager.setLastName("Nowak");
        resourceManager.setAddress(address4);
        userManager.createUser(resourceManager, UserType.RESOURCE_MANAGER);
        userManager.findAllUsers().get(3).setActive(false);
        VirtualDatabaseServer virtualDatabaseServer = new VirtualDatabaseServer();
        virtualDatabaseServer.setCpuCores(16);
        virtualDatabaseServer.setRam(64);
        virtualDatabaseServer.setStorageSize(2048);
        virtualDatabaseServer.setDatabaseType(DatabaseType.MONGODB);
        virtualDeviceManager.createVirtualDevice(virtualDatabaseServer, VirtualDeviceType.VIRTUAL_DATABASE_SERVER);
        VirtualMachine virtualMachine = new VirtualMachine();
        virtualMachine.setCpuCores(8);
        virtualMachine.setRam(32);
        virtualMachine.setStorageSize(1024);
        virtualMachine.setOperatingSystemType(OperatingSystemType.FEDORA);
        virtualDeviceManager.createVirtualDevice(virtualMachine, VirtualDeviceType.VIRTUAL_MACHINE);
        VirtualPhone virtualPhone = new VirtualPhone();
        virtualPhone.setCpuCores(4);
        virtualPhone.setRam(16);
        virtualPhone.setStorageSize(512);
        virtualPhone.setPhoneNumber(123456789);
        virtualDeviceManager.createVirtualDevice(virtualPhone, VirtualDeviceType.VIRTUAL_PHONE);
        Rent rent1 = new Rent();
        rent1.setUserId(userManager.findAllUsers().get(0).getId());
        rent1.setVirtualDeviceId(virtualDeviceManager.findAllVirtualDevices().get(0).getId());
        rent1.setStartLocalDateTime(LocalDateTime.now().plusDays(1));
        rent1.setEndLocalDateTime(LocalDateTime.now().plusWeeks(2L));
        rentManager.createRent(rent1);
        Rent rent2 = new Rent();
        rent2.setUserId(userManager.findAllUsers().get(1).getId());
        rent2.setVirtualDeviceId(virtualDeviceManager.findAllVirtualDevices().get(0).getId());
        rent2.setStartLocalDateTime(LocalDateTime.now().minusDays(5));
        rent2.setEndLocalDateTime(LocalDateTime.now().minusDays(1));
        rentManager.createRent(rent2);
        userManager.findAllUsers().get(3).setActive(false);
    }
}
